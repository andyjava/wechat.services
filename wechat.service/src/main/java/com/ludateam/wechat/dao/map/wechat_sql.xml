<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ludateam.wechat.dao.SearchDao">
    <insert id="saveReseiceMsg" parameterType="Map">
		<![CDATA[
			INSERT INTO db_wx.wechat_receive_message
			  (msg_id,
			   to_user_name,
			   from_user_name,
			   create_time,
			   msg_type,
			   content,
			   pic_url,
			   media_id,
			   agent_id)
			VALUES
			  (
			  	#{msgId},
			  	#{toUserName},
			  	#{fromUserName},
			  	TO_DATE(#{createTime},'yyyy-MM-dd HH24:mi:ss'),
			  	#{msgType},
			  	#{content, jdbcType=VARCHAR},
			  	#{picUrl, jdbcType=VARCHAR},
			  	#{mediaId, jdbcType=VARCHAR},
			  	#{agentId}
			  )
        ]]>
    </insert>
	<select id="getTaskList" resultType="Map">
		<![CDATA[
			SELECT tmp.rwid AS "rwid", tmp.dxnr AS "dxnr"
			  FROM (SELECT t.rwid, t.dxnr FROM db_zgfz.t_fsrw t WHERE t.fszt is null ORDER BY t.cjsj desc) tmp
			 WHERE ROWNUM BETWEEN 1 AND 3
        ]]>
    </select>
	<select id="getSendListByTaskid" parameterType="Decimal" resultType="Map">
		<![CDATA[
			SELECT t.sjhm AS "sjhm", t.wxzhid AS "wxzhid", t.jhzt AS "jhzt"
			FROM db_zgfz.t_fsmd t WHERE t.rwid = #{rwid}
        ]]>
    </select>
   	<update id="updateWechatInfo" parameterType="Map">
   		<![CDATA[
			UPDATE db_zgfz.t_fsmd t SET t.wxzhid = #{wxzhid, jdbcType=VARCHAR} , t.jhzt = #{jhzt, jdbcType=VARCHAR}
			WHERE t.rwid = #{rwid} AND t.sjhm = #{sjhm}
        ]]>
    </update>
   	<update id="updateTaskStatus" parameterType="Map">
   		<![CDATA[
   			UPDATE db_zgfz.t_fsrw t SET t.fszt =#{fszt, jdbcType=VARCHAR} , t.sbyy=#{sbyy, jdbcType=VARCHAR} WHERE t.rwid=#{rwid}
        ]]>
    </update>
</mapper>